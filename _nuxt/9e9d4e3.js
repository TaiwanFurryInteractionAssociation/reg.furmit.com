(window.webpackJsonp=window.webpackJsonp||[]).push([[36,5],{373:function(t,r,e){"use strict";e.r(r);var n=e(137),o=e.n(n),c={props:{type:{type:String,default:"primary"}},computed:{computedStyle:function(){return{background:o.a[this.type].background,color:o.a[this.type].color}}},mounted:function(){this.button=this.$refs.button}},d=e(20),component=Object(d.a)(c,(function(){var t=this,r=t._self._c;return r("div",[r("button",{ref:"button",staticClass:"b:0 p:8|16 w:100% border-radius:4 cursor:pointer transform:translateY(-2):hover transition:0.2s",style:t.computedStyle,on:{click:function(r){return r.preventDefault(),t.$emit("click")}}},[t._t("default")],2)])}),[],!1,null,null,null);r.default=component.exports;installComponents(component,{Button:e(373).default})},417:function(t,r,e){var content=e(473);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,e(62).default)("a50c6942",content,!0,{sourceMap:!1})},472:function(t,r,e){"use strict";e(417)},473:function(t,r,e){var n=e(61)(!1);n.push([t.i,"table.furstarsRundown{border-collapse:collapse}table.furstarsRundown td{padding:4px 8px;border-bottom:1px solid #000}table.furstarsRundown td:first-child,td:last-child{padding:4px 0}",""]),t.exports=n},529:function(t,r,e){"use strict";e.r(r);e(41);var n=e(3),o=(e(22),e(45),e(71)),c={layout:"admin",components:{},data:function(){var t={tutorial:"規則說明",lobby:"主畫面",showcase:"開始演出",showcase_red:"紅隊演出",showcase_black:"黑隊演出",voting:"回合投票",result:"回合投票結果",midresult:"上半場投票結果",transition:"過場畫面",finalresult:"投票結果一覽",prize:"冠軍畫面",good:"贊"};return{loading:!1,scenes:t,furstarsTeams:{},furstarsRundownSteps:{},dataLoaded:{},furstarsScenes:t}},mounted:function(){this.getFurstarsTeams()},watch:{},methods:{getFurstarsTeams:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.loading=!0,r.next=3,t.$axios.get("/api/admin/furmit/furstars/teams").then((function(r){t.furstarsTeams={},r.data.furstarsTeams.map((function(r){var e=r.mit_furstars_team_id;t.furstarsTeams[e]=r})),t.dataLoaded.furstarsTeams=!0,t.dataLoaded.furstarsTeams&&t.getFurstarsRundownSteps()})).catch((function(t){o.a.showRequestError(t)}));case 3:t.loading=!1;case 4:case"end":return r.stop()}}),r)})))()},getFurstarsRundownSteps:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function r(){var output;return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return t.loading=!0,output=[],r.next=4,t.$axios.get("/api/admin/furmit/furstars/rundownSteps").then((function(r){var e={furstarsTeams:t.furstarsTeams};r.data.furstarsRundownSteps.map((function(t){["showcase"].includes(t.mit_furstars_rundown_step_scene)||(t.z=e,output.push(t))})),t.furstarsRundownSteps=output})).catch((function(t){o.a.showRequestError(t)}));case 4:t.loading=!1;case 5:case"end":return r.stop()}}),r)})))()},goToStep:function(t){var r=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.loading=!0,r,e.next=4,r.$axios.post("/api/admin/furmit/furstars/status/go/".concat(t)).then((function(t){r.getFurstarsRundownSteps()})).catch((function(t){o.a.showRequestError(t)}));case 4:r.loading=!1;case 5:case"end":return e.stop()}}),e)})))()},stopVotes:function(t){var r=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.loading=!0,r,e.next=4,r.$axios.post("/api/admin/furmit/furstars/status/go/".concat(t,"/stop")).then((function(t){r.getFurstarsRundownSteps()})).catch((function(t){o.a.showRequestError(t)}));case 4:r.loading=!1;case 5:case"end":return e.stop()}}),e)})))()},settlement:function(t){var r=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(confirm("每個階段只能結算一次，確認要進行結算並派發獎勵嗎？")){e.next=2;break}return e.abrupt("return");case 2:return r.loading=!0,r,e.next=6,r.$axios.post("/api/admin/furmit/furstars/status/go/".concat(t,"/settlement")).then((function(t){alert("已完成結算並派發獎勵"),r.getFurstarsRundownSteps()})).catch((function(t){o.a.showRequestError(t)}));case 6:r.loading=!1;case 7:case"end":return e.stop()}}),e)})))()}}},d=(e(472),e(20)),component=Object(d.a)(c,(function(){var t=this,r=t._self._c;return r("div",{staticClass:"p:16 overflow:auto"},[r("Loading",{attrs:{value:t.loading}}),t._v(" "),r("div",{staticClass:"font-size:2rem"},[t._v("FurStars 階段管理")]),t._v(" "),r("div",{staticClass:"font-size:1.5rem mt:16 mb:8"},[t._v("階段清單")]),t._v(" "),r("table",{staticClass:"furstarsRundown"},[r("tbody",t._l(t.furstarsRundownSteps,(function(e){return r("tr",[r("td",{staticClass:"action",staticStyle:{"text-align":"right"}},[e.mit_furstars_rundown_step_is_current?r("Button",{attrs:{type:"negative"}},[t._v("進行中")]):r("Button",{attrs:{type:"primary"},on:{click:function(r){return t.goToStep(e.mit_furstars_rundown_step_id)}}},[t._v("開始")])],1),t._v(" "),r("td",[["showcase","showcase_red","showcase_black","voting","result"].includes(e.mit_furstars_rundown_step_scene)?r("span",[t._v("#"+t._s(parseInt(e.mit_furstars_rundown_step_stage/10)))]):t._e()]),t._v(" "),r("td",[t._v(t._s(t.scenes[e.mit_furstars_rundown_step_scene]))]),t._v(" "),r("td",[["showcase","showcase_red","voting","result"].includes(e.mit_furstars_rundown_step_scene)?r("span",{staticStyle:{"background-color":"red",color:"white",padding:"4px 8px","border-radius":"3px"}},[t._v(t._s(t.furstarsTeams[e.mit_furstars_rundown_step_red_team_id].mit_furstars_team_name))]):t._e()]),t._v(" "),r("td",[["showcase","showcase_black","voting","result"].includes(e.mit_furstars_rundown_step_scene)?r("span",{staticStyle:{"background-color":"black",color:"white",padding:"4px 8px","border-radius":"3px"}},[t._v(t._s(t.furstarsTeams[e.mit_furstars_rundown_step_black_team_id].mit_furstars_team_name))]):t._e()]),t._v(" "),r("td",{staticClass:"action"},[["voting"].includes(e.mit_furstars_rundown_step_scene)&&e.mit_furstars_rundown_step_is_current?r("Button",{attrs:{type:"primary"},on:{click:function(r){return t.stopVotes(e.mit_furstars_rundown_step_id)}}},[t._v("關閉投票")]):t._e(),t._v(" "),["result","prize"].includes(e.mit_furstars_rundown_step_scene)&&e.mit_furstars_rundown_step_is_current?r("Button",{attrs:{type:"primary"},on:{click:function(r){return t.settlement(e.mit_furstars_rundown_step_id)}}},[t._v("結算")]):t._e()],1)])})),0)])],1)}),[],!1,null,null,null);r.default=component.exports;installComponents(component,{Loading:e(171).default,Button:e(373).default})}}]);