(window.webpackJsonp=window.webpackJsonp||[]).push([[42,5,10],{373:function(t,e,n){"use strict";n.r(e);var r=n(137),o=n.n(r),c={props:{type:{type:String,default:"primary"}},computed:{computedStyle:function(){return{background:o.a[this.type].background,color:o.a[this.type].color}}},mounted:function(){this.button=this.$refs.button}},m=n(20),component=Object(m.a)(c,(function(){var t=this,e=t._self._c;return e("div",[e("button",{ref:"button",staticClass:"b:0 p:8|16 w:100% border-radius:4 cursor:pointer transform:translateY(-2):hover transition:0.2s",style:t.computedStyle,on:{click:function(e){return e.preventDefault(),t.$emit("click")}}},[t._t("default")],2)])}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Button:n(373).default})},383:function(t,e,n){"use strict";n.r(e);var r={},o=n(20),component=Object(o.a)(r,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"flex"},[e("Button",{staticClass:"mr:8",on:{click:function(e){return t.params.editHandler(t.params)}}},[t._v(t._s(t.$t("common.edit")))]),t._v(" "),e("Button",{attrs:{type:"negative"},on:{click:function(e){return t.params.deleteHandler(t.params)}}},[t._v(t._s(t.$t("common.delete")))])],1)}),[],!1,null,null,null);e.default=component.exports;installComponents(component,{Button:n(373).default})},418:function(t,e,n){var content=n(475);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,n(62).default)("262488bd",content,!0,{sourceMap:!1})},474:function(t,e,n){"use strict";n(418)},475:function(t,e,n){var r=n(61)(!1);r.push([t.i,"table.furstarsRundown[data-v-5d132e4f]{border-collapse:collapse}table.furstarsRundown td[data-v-5d132e4f]{padding:4px 8px;border-bottom:1px solid #000}table.furstarsRundown td[data-v-5d132e4f]:first-child,td[data-v-5d132e4f]:last-child{padding:4px 0}",""]),t.exports=r},535:function(t,e,n){"use strict";n.r(e);var r=n(3),o=(n(22),n(45),n(71)),c=n(72),m=n.n(c),_={layout:"admin",components:{ReaderButtonsCellRenderer:n(383).default},data:function(){return{loading:!1,defaultColumnDef:{sortable:!0,filter:!0,floatingFilter:!0,resizable:!0},config:m.a.getConfig(),adminConfig:m.a.getAdminConfig(),mitMinoritiesQuestions:null,mitMinoritiesStages:null,yesNoValues:{true:"Yes",false:"No"},hasBeenUsed:{true:"已完成問答",false:"尚未應答"},stageTypes:{vote:"投票",sort:"結算",notStarted:"等待開始",ended:"結束"},votes:null}},mounted:function(){this.getMitMinoritiesQuestions(),this.getMitMinoritiesStages(),this.getCurrentVotes()},methods:{timestampToDateTime:function(t){return new Date(1e3*t).toLocaleString("zh-TW",{hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})},getMitMinoritiesQuestions:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,t.$axios.get("/api/admin/furmit/minorities/questions").then((function(e){t.mitMinoritiesQuestions={},e.data.mitMinoritiesQuestions.map((function(e){t.mitMinoritiesQuestions[e.mit_minorities_question_id]=e}))})).catch((function(t){o.a.showRequestError(t)}));case 3:t.loading=!1;case 4:case"end":return e.stop()}}),e)})))()},getMitMinoritiesStages:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,e.next=3,t.$axios.get("/api/admin/furmit/minorities/stages").then((function(e){var n={questions:t.mitMinoritiesQuestions};e.data.mitMinoritiesStages.map((function(e){e.mit_minorities_stage_time_start&&(e.mit_minorities_stage_time_start=t.timestampToDateTime(e.mit_minorities_stage_time_start)),e.mit_minorities_stage_time_end&&(e.mit_minorities_stage_time_end=t.timestampToDateTime(e.mit_minorities_stage_time_end)),e.z=n})),t.mitMinoritiesStages=e.data.mitMinoritiesStages})).catch((function(t){o.a.showRequestError(t)}));case 3:t.loading=!1;case 4:case"end":return e.stop()}}),e)})))()},getCurrentVotes:function(){var t=this;return Object(r.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.loading=!0,t,e.next=4,t.$axios.get("/api/admin/furmit/minorities/status/votes").then((function(e){t.votes=e.data.votes})).catch((function(t){o.a.showRequestError(t)}));case 4:t.loading=!1;case 5:case"end":return e.stop()}}),e)})))()},goToStage:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.loading=!0,e,n.next=4,e.$axios.post("/api/admin/furmit/minorities/status/go/".concat(t)).then((function(t){e.getMitMinoritiesStages(),e.getCurrentVotes()})).catch((function(t){o.a.showRequestError(t)}));case 4:e.loading=!1;case 5:case"end":return n.stop()}}),n)})))()},settlement:function(t){var e=this;return Object(r.a)(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(confirm("每個階段只能結算一次，確認要進行結算並刷掉多數人嗎？")){n.next=2;break}return n.abrupt("return");case 2:return e.loading=!0,e,n.next=6,e.$axios.post("/api/admin/furmit/minorities/status/go/".concat(t,"/settlement")).then((function(t){alert("已完成結算並刷掉多數群眾（？）"),e.getMitMinoritiesStages(),e.getCurrentVotes()})).catch((function(t){o.a.showRequestError(t)}));case 6:e.loading=!1;case 7:case"end":return n.stop()}}),n)})))()}}},d=(n(474),n(20)),component=Object(d.a)(_,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"p:16 overflow:auto"},[e("Loading",{attrs:{value:t.loading}}),t._v(" "),e("div",{staticClass:"font-size:2rem"},[t._v("少數決階段管理")]),t._v(" "),e("div",{staticClass:"font-size:1.5rem mt:16 mb:8"},[t._v("階段清單")]),t._v(" "),e("table",{staticClass:"furstarsRundown"},[e("tbody",t._l(t.mitMinoritiesStages,(function(n){return e("tr",[e("td",{staticClass:"action",staticStyle:{"text-align":"right"}},[n.mit_minorities_stage_is_current?e("Button",{attrs:{type:"negative"}},[t._v("進行中")]):e("Button",{attrs:{type:"primary"},on:{click:function(e){return t.goToStage(n.mit_minorities_stage_id)}}},[t._v("開始")])],1),t._v(" "),e("td",[t._v("\n          "+t._s(t.stageTypes[n.mit_minorities_stage_type])+"\n        ")]),t._v(" "),e("td",["vote"==n.mit_minorities_stage_type?e("span",["vote"==n.mit_minorities_stage_type&&t.mitMinoritiesQuestions[n.mit_minorities_question_id].mit_minorities_question_used?e("span",{staticStyle:{padding:"2px 4px","background-color":"red",color:"white","margin-right":"8px"}},[t._v("\n                  "+t._s(t.hasBeenUsed[t.mitMinoritiesQuestions[n.mit_minorities_question_id].mit_minorities_question_used])+"\n              ")]):t._e(),t._v("\n              "+t._s(t.$t("minorities.questions.".concat(t.mitMinoritiesQuestions[n.mit_minorities_question_id].mit_minorities_question_code)))+"\n          ")]):t._e()]),t._v(" "),e("td",["vote"==n.mit_minorities_stage_type&&t.votes?e("span",[t._v("\n            Y: "+t._s(t.votes[n.mit_minorities_stage_id].yes)),e("br"),t._v("\n            N: "+t._s(t.votes[n.mit_minorities_stage_id].no)+"\n          ")]):t._e()]),t._v(" "),e("td",["vote"==n.mit_minorities_stage_type?e("span",[t._v("\n              "+t._s(n.mit_minorities_stage_time_start)+" ~                \n              "+t._s(n.mit_minorities_stage_time_end)+"\n          ")]):t._e()]),t._v(" "),e("td",{staticClass:"action"},["vote"==n.mit_minorities_stage_type&&n.mit_minorities_stage_is_current?e("Button",{attrs:{type:"primary"},on:{click:function(e){return t.settlement(n.mit_minorities_stage_id)}}},[t._v("結算")]):t._e()],1)])})),0)])],1)}),[],!1,null,"5d132e4f",null);e.default=component.exports;installComponents(component,{Loading:n(171).default,Button:n(373).default})}}]);